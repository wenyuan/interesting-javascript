# Head First JavaScript

> 深入浅出JavaScript，重学JavaScript，JavaScript学习笔记，JavaScript知识点记录

## 一、编译原理
1. JavaScript是一门编译语言  
    与传统编译语言略有不同，它不是提前编译的。但JavaScript引擎进行编译的步骤和传统编译语言非常相似。  
2. 传统编译过程  
* **分词/词法分析（Tokenizing/Lexing）**
    这个过程将字符串（例如 `var a = 2;` ）分解成有意义的代码块( `var`, `a`, `=`, `2`, `;` )，这些代码块被称为词法单元（token）。  
    **解析/语法分析（Parsing）**，这个过程是将词法单元流（数组）转换成一个由元素逐级嵌套所组成的代表了程序语法结构的树。这个树被称为“抽象语法树”（Abstract Syntax Tree，AST）。  
    **代码生成**，将AST转换为可执行代码的过程。  
3. JavaScript编译特点  
    对于JavaScript来说，大部分情况下编译发生在代码执行前的几微妙（甚至更短）。  
    JavaScript引擎用尽了各种办法（比如JIT，可以延迟编译甚至实施重编译）来保证性能最佳。  

## 二、作用域
1. 参与程序处理的三个成员  
    **引擎**，从头到尾负责整个JavaScript程序的编译及执行过程。  
    **编译器**，负责语法分析及代码生成。  
    **作用域**，用于确定在何处以及如何查找变量（标识符）的一套规则。   
2. 引擎查找变量的方式  
    如果查找的目的是对变量进行赋值，那么就会使用**LHS**查询，  
    如果查找的目的是获取变量的值，就会使用**RHS**查询。  
    赋值操作符会导致**LHS**查询，`=`操作符或调用函数时传入参数的操作都会导致关联作用域的赋值操作。  
3. 变量赋值的过程拆解（`var a = 2;`）  
    在代码执行前，首先编译器会在当前作用域中声明一个变量（`var a`）（如果之前没有声明过），  
    在运行时，引擎会在作用域中查询（LHS查询）变量a并对其进行赋值。  
4. 异常  
    如果RHS查询在所有嵌套的作用域中都找不到所需的变量，引擎就会抛出 `ReferenceError` 异常；  
    如果LHS查询在所有嵌套的作用域中都找不到所需的变量，全局作用域中就会自动隐式地创建一个具有该名称的变量（非严格模式），或者抛出 `ReferenceError` 异常（严格模式下）；  
    如果RHS查询找到了一个变量，但是你对这个变量的值进行不合理的操作，引擎就会抛出 `TypeError` 异常。  
